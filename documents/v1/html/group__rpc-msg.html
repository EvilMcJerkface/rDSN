<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>rDSN: RPC Message Utilities</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rDSN
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">RPC Message Utilities<div class="ingroups"><a class="el" href="group__layer1-dev.html">Write Applications in rDSN</a> &raquo; <a class="el" href="group__layer1-dev-c.html">Core API</a> &raquo; <a class="el" href="group__rpc.html">Remote Procedure Call (RPC)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>RPC Message Utilities.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uniondsn__msg__context__t.html">dsn_msg_context_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">RPC message context.  <a href="uniondsn__msg__context__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">options for RPC messages, used by <a class="el" href="group__rpc-msg.html#gae423fd37b63d972b4c752bf895652c14">dsn_msg_set_options</a> and <a class="el" href="group__rpc-msg.html#ga4c16069d272174bd4dfc064cb7153341">dsn_msg_get_options</a>  <a href="structdsn__msg__options__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdsn_1_1rpc__read__stream.html">dsn::rpc_read_stream</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdsn_1_1rpc__write__stream.html">dsn::rpc_write_stream</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga3c45b77bb8ee51d0ede7cbc2b0a00280"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3c45b77bb8ee51d0ede7cbc2b0a00280"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga3c45b77bb8ee51d0ede7cbc2b0a00280">DSN_MSGM_TIMEOUT</a>&#160;&#160;&#160;(0x1 &lt;&lt; 0)</td></tr>
<tr class="memdesc:ga3c45b77bb8ee51d0ede7cbc2b0a00280"><td class="mdescLeft">&#160;</td><td class="mdescRight">msg timeout is to be set/get <br /></td></tr>
<tr class="separator:ga3c45b77bb8ee51d0ede7cbc2b0a00280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2a74b88c12e07169175493a16f6151d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae2a74b88c12e07169175493a16f6151d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gae2a74b88c12e07169175493a16f6151d">DSN_MSGM_HASH</a>&#160;&#160;&#160;(0x1 &lt;&lt; 1)</td></tr>
<tr class="memdesc:gae2a74b88c12e07169175493a16f6151d"><td class="mdescLeft">&#160;</td><td class="mdescRight">thread hash is to be set/get <br /></td></tr>
<tr class="separator:gae2a74b88c12e07169175493a16f6151d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4540651fb764cef8914a9f3c7a78e55"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa4540651fb764cef8914a9f3c7a78e55"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gaa4540651fb764cef8914a9f3c7a78e55">DSN_MSGM_VNID</a>&#160;&#160;&#160;(0x1 &lt;&lt; 2)</td></tr>
<tr class="memdesc:gaa4540651fb764cef8914a9f3c7a78e55"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual node id (vnid) is to be set/get <br /></td></tr>
<tr class="separator:gaa4540651fb764cef8914a9f3c7a78e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a69468a79b4c9ad37274b194f86dfec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8a69468a79b4c9ad37274b194f86dfec"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga8a69468a79b4c9ad37274b194f86dfec">DSN_MSGM_CONTEXT</a>&#160;&#160;&#160;(0x1 &lt;&lt; 3)</td></tr>
<tr class="memdesc:ga8a69468a79b4c9ad37274b194f86dfec"><td class="mdescLeft">&#160;</td><td class="mdescRight">rpc message context is to be set/get <br /></td></tr>
<tr class="separator:ga8a69468a79b4c9ad37274b194f86dfec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga06b25951772fa62d300e73e080625d83"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga06b25951772fa62d300e73e080625d83"></a>
typedef union <a class="el" href="uniondsn__msg__context__t.html">dsn_msg_context_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga06b25951772fa62d300e73e080625d83">dsn_msg_context_t</a></td></tr>
<tr class="memdesc:ga06b25951772fa62d300e73e080625d83"><td class="mdescLeft">&#160;</td><td class="mdescRight">RPC message context. <br /></td></tr>
<tr class="separator:ga06b25951772fa62d300e73e080625d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58b4db21e3556c5cda8fa0b17f795fe7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga58b4db21e3556c5cda8fa0b17f795fe7"></a>
typedef struct <a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga58b4db21e3556c5cda8fa0b17f795fe7">dsn_msg_options_t</a></td></tr>
<tr class="memdesc:ga58b4db21e3556c5cda8fa0b17f795fe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">options for RPC messages, used by <a class="el" href="group__rpc-msg.html#gae423fd37b63d972b4c752bf895652c14">dsn_msg_set_options</a> and <a class="el" href="group__rpc-msg.html#ga4c16069d272174bd4dfc064cb7153341">dsn_msg_get_options</a> <br /></td></tr>
<tr class="separator:ga58b4db21e3556c5cda8fa0b17f795fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0528aaf4642c0218a002a1181f9a0f81"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0528aaf4642c0218a002a1181f9a0f81"></a>
typedef ::dsn::ref_ptr&lt; rpc_read_stream &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>dsn::rpc_read_stream_ptr</b></td></tr>
<tr class="separator:ga0528aaf4642c0218a002a1181f9a0f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e333a774d145e6097dac9086d2fe847"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga4e333a774d145e6097dac9086d2fe847"></a>
typedef ::dsn::ref_ptr&lt; rpc_write_stream &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>dsn::rpc_write_stream_ptr</b></td></tr>
<tr class="separator:ga4e333a774d145e6097dac9086d2fe847"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6677aae211f9ff57a5854ed8bba831ff"><td class="memItemLeft" align="right" valign="top">DSN_API dsn_message_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga6677aae211f9ff57a5854ed8bba831ff">dsn_msg_create_request</a> (dsn_task_code_t rpc_code, int timeout_milliseconds DEFAULT(0), int hash DEFAULT(0))</td></tr>
<tr class="memdesc:ga6677aae211f9ff57a5854ed8bba831ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">create a rpc request message  <a href="#ga6677aae211f9ff57a5854ed8bba831ff">More...</a><br /></td></tr>
<tr class="separator:ga6677aae211f9ff57a5854ed8bba831ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32effda3b6638effbbdca85e6e5777ea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga32effda3b6638effbbdca85e6e5777ea"></a>
DSN_API dsn_message_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga32effda3b6638effbbdca85e6e5777ea">dsn_msg_create_response</a> (dsn_message_t request)</td></tr>
<tr class="memdesc:ga32effda3b6638effbbdca85e6e5777ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">create a RPC response message correspondent to the given request message <br /></td></tr>
<tr class="separator:ga32effda3b6638effbbdca85e6e5777ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffb255d88d26767e021e90700538f229"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaffb255d88d26767e021e90700538f229"></a>
DSN_API dsn_message_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gaffb255d88d26767e021e90700538f229">dsn_msg_copy</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gaffb255d88d26767e021e90700538f229"><td class="mdescLeft">&#160;</td><td class="mdescRight">make a copy of the given message <br /></td></tr>
<tr class="separator:gaffb255d88d26767e021e90700538f229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6386342939aa4e474358aeaef8863a4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac6386342939aa4e474358aeaef8863a4"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gac6386342939aa4e474358aeaef8863a4">dsn_msg_add_ref</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gac6386342939aa4e474358aeaef8863a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">add reference to the message, paired with /ref dsn_msg_release_ref <br /></td></tr>
<tr class="separator:gac6386342939aa4e474358aeaef8863a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad58a7ee8f0039af623a022a0b32e2872"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad58a7ee8f0039af623a022a0b32e2872"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gad58a7ee8f0039af623a022a0b32e2872">dsn_msg_release_ref</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gad58a7ee8f0039af623a022a0b32e2872"><td class="mdescLeft">&#160;</td><td class="mdescRight">release reference to the message, paired with /ref dsn_msg_add_ref <br /></td></tr>
<tr class="separator:gad58a7ee8f0039af623a022a0b32e2872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga15802c3b3b64e6c205ff546232ff6267"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga15802c3b3b64e6c205ff546232ff6267"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga15802c3b3b64e6c205ff546232ff6267">dsn_address_size_checker</a> ()</td></tr>
<tr class="memdesc:ga15802c3b3b64e6c205ff546232ff6267"><td class="mdescLeft">&#160;</td><td class="mdescRight">make sure type sizes match as we simply use uint64_t across language boundaries <br /></td></tr>
<tr class="separator:ga15802c3b3b64e6c205ff546232ff6267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae423fd37b63d972b4c752bf895652c14"><td class="memItemLeft" align="right" valign="top">DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gae423fd37b63d972b4c752bf895652c14">dsn_msg_set_options</a> (dsn_message_t msg, <a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a> *opts, uint32_t mask)</td></tr>
<tr class="memdesc:gae423fd37b63d972b4c752bf895652c14"><td class="mdescLeft">&#160;</td><td class="mdescRight">set options for the given message  <a href="#gae423fd37b63d972b4c752bf895652c14">More...</a><br /></td></tr>
<tr class="separator:gae423fd37b63d972b4c752bf895652c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c16069d272174bd4dfc064cb7153341"><td class="memItemLeft" align="right" valign="top">DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga4c16069d272174bd4dfc064cb7153341">dsn_msg_get_options</a> (dsn_message_t msg, <a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a> *opts)</td></tr>
<tr class="memdesc:ga4c16069d272174bd4dfc064cb7153341"><td class="mdescLeft">&#160;</td><td class="mdescRight">get options for the given message  <a href="#ga4c16069d272174bd4dfc064cb7153341">More...</a><br /></td></tr>
<tr class="separator:ga4c16069d272174bd4dfc064cb7153341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa0dfbbcc3391ca32a419b97e9a043d8d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa0dfbbcc3391ca32a419b97e9a043d8d"></a>
DSN_API size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gaa0dfbbcc3391ca32a419b97e9a043d8d">dsn_msg_body_size</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gaa0dfbbcc3391ca32a419b97e9a043d8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">get message body size <br /></td></tr>
<tr class="separator:gaa0dfbbcc3391ca32a419b97e9a043d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafa5b34a962e5de397de08951b194690"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaafa5b34a962e5de397de08951b194690"></a>
DSN_API void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gaafa5b34a962e5de397de08951b194690">dsn_msg_rw_ptr</a> (dsn_message_t msg, size_t offset_begin)</td></tr>
<tr class="memdesc:gaafa5b34a962e5de397de08951b194690"><td class="mdescLeft">&#160;</td><td class="mdescRight">get read/write pointer with the given offset <br /></td></tr>
<tr class="separator:gaafa5b34a962e5de397de08951b194690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga792fd9142ce0ffdf6761dc8c98d8ae8e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga792fd9142ce0ffdf6761dc8c98d8ae8e"></a>
DSN_API <a class="el" href="structdsn__address__t.html">dsn_address_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga792fd9142ce0ffdf6761dc8c98d8ae8e">dsn_msg_from_address</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:ga792fd9142ce0ffdf6761dc8c98d8ae8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get from-address where the message is sent <br /></td></tr>
<tr class="separator:ga792fd9142ce0ffdf6761dc8c98d8ae8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae321ef447b5e42dedcc02326a41b53d3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae321ef447b5e42dedcc02326a41b53d3"></a>
DSN_API <a class="el" href="structdsn__address__t.html">dsn_address_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gae321ef447b5e42dedcc02326a41b53d3">dsn_msg_to_address</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gae321ef447b5e42dedcc02326a41b53d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">get to-address where the message is sent to <br /></td></tr>
<tr class="separator:gae321ef447b5e42dedcc02326a41b53d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbdef6576461eadd489e110fa97f589f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabbdef6576461eadd489e110fa97f589f"></a>
DSN_API uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gabbdef6576461eadd489e110fa97f589f">dsn_msg_rpc_id</a> (dsn_message_t msg)</td></tr>
<tr class="memdesc:gabbdef6576461eadd489e110fa97f589f"><td class="mdescLeft">&#160;</td><td class="mdescRight">get rpc id of the message <br /></td></tr>
<tr class="separator:gabbdef6576461eadd489e110fa97f589f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5a5b3789b1bb3f02f8b1bd8653aa47d"><td class="memItemLeft" align="right" valign="top">DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gab5a5b3789b1bb3f02f8b1bd8653aa47d">dsn_msg_write_next</a> (dsn_message_t msg, void **ptr, size_t *size, size_t min_size)</td></tr>
<tr class="memdesc:gab5a5b3789b1bb3f02f8b1bd8653aa47d"><td class="mdescLeft">&#160;</td><td class="mdescRight">get message write buffer  <a href="#gab5a5b3789b1bb3f02f8b1bd8653aa47d">More...</a><br /></td></tr>
<tr class="separator:gab5a5b3789b1bb3f02f8b1bd8653aa47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22fca00b819f5b4d37e37b86e22a86eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga22fca00b819f5b4d37e37b86e22a86eb"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga22fca00b819f5b4d37e37b86e22a86eb">dsn_msg_write_commit</a> (dsn_message_t msg, size_t size)</td></tr>
<tr class="memdesc:ga22fca00b819f5b4d37e37b86e22a86eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">commit the write buffer after the message content is written with the real written size <br /></td></tr>
<tr class="separator:ga22fca00b819f5b4d37e37b86e22a86eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab86d05d5ba0b278caa1624ef390fc5f3"><td class="memItemLeft" align="right" valign="top">DSN_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#gab86d05d5ba0b278caa1624ef390fc5f3">dsn_msg_read_next</a> (dsn_message_t msg, void **ptr, size_t *size)</td></tr>
<tr class="memdesc:gab86d05d5ba0b278caa1624ef390fc5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">get message read buffer  <a href="#gab86d05d5ba0b278caa1624ef390fc5f3">More...</a><br /></td></tr>
<tr class="separator:gab86d05d5ba0b278caa1624ef390fc5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58926b23bb18118f5174faa46f6769d0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga58926b23bb18118f5174faa46f6769d0"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpc-msg.html#ga58926b23bb18118f5174faa46f6769d0">dsn_msg_read_commit</a> (dsn_message_t msg, size_t size)</td></tr>
<tr class="memdesc:ga58926b23bb18118f5174faa46f6769d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">commit the read buffer after the message content is read with the real read size, it is possible to use a different size to allow duplicated or skipped read in the message. <br /></td></tr>
<tr class="separator:ga58926b23bb18118f5174faa46f6769d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>RPC Message Utilities. </p>
<p>rpc message and buffer management</p>
<p>all returned dsn_message_t are NOT add_ref by rDSN, so you do not need to call msg_release_ref to release the msgs. the decision is made for easier programming, and you may consider the later dsn_rpc_xxx calls do the resource gc work for you. however, if you want to hold the message further after call dsn_rpc_xxx, you need to call dsn_msg_add_ref first before these operations, and call dsn_msg_release_ref later to ensure there is no memory leak. This is very similar to what we have above with task handles. however, this is not true for returned message from dsn_rpc_call_wait and dsn_rpc_get_response. For these two cases, developers are responsible for releasing the message handle by calling dsn_msg_release_ref. similarily, for all msgs accessable in callbacks, if you want to hold them in upper apps further beyond the callbacks, you need to call msg_add_ref, and msg_release_ref explicitly. when timeout_milliseconds == 0, [task.rpc_code%] rpc_timeout_milliseconds is used.</p>
<p>rpc message read/write</p>
<pre>
// apps write rpc message as follows:
       void* ptr;
       size_t size;
       dsn_msg_write_next(msg, &amp;ptr, &amp;size, min_size);
       write msg content to [ptr, ptr + size)
       dsn_msg_write_commit(msg, real_written_size);</pre><pre>// apps read rpc message as follows:
       void* ptr;
       size_t size;
       dsn_msg_read_next(msg, &amp;ptr, &amp;size);
       read msg content in [ptr, ptr + size)
       dsn_msg_read_commit(msg, real read size);
// if not committed, next dsn_msg_read_next returns the same read buffer
</pre> <h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga6677aae211f9ff57a5854ed8bba831ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DSN_API dsn_message_t dsn_msg_create_request </td>
          <td>(</td>
          <td class="paramtype">dsn_task_code_t&#160;</td>
          <td class="paramname"><em>rpc_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int timeout_milliseconds &#160;</td>
          <td class="paramname"><em>DEFAULT</em>0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int hash &#160;</td>
          <td class="paramname"><em>DEFAULT</em>0&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create a rpc request message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rpc_code</td><td>task code for this request </td></tr>
    <tr><td class="paramname">timeout_milliseconds</td><td>timeout for the RPC call, 0 for default value as configued in config files for the task code </td></tr>
    <tr><td class="paramname">hash</td><td>if the task code is bound to a partitioned thread pool, a hash value is needed to specify which thread in the pool should handle the request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RPC message handle </dd></dl>

</div>
</div>
<a class="anchor" id="gae423fd37b63d972b4c752bf895652c14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DSN_API void dsn_msg_set_options </td>
          <td>(</td>
          <td class="paramtype">dsn_message_t&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a> *&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set options for the given message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>the message handle </td></tr>
    <tr><td class="paramname">opts</td><td>options to be set in the message </td></tr>
    <tr><td class="paramname">mask</td><td>the mask composed using e.g., DSN_MSGM_TIMEOUT above to specify what to set </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga4c16069d272174bd4dfc064cb7153341"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DSN_API void dsn_msg_get_options </td>
          <td>(</td>
          <td class="paramtype">dsn_message_t&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdsn__msg__options__t.html">dsn_msg_options_t</a> *&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get options for the given message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>the message handle </td></tr>
    <tr><td class="paramname">opts</td><td>options to be get </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gab5a5b3789b1bb3f02f8b1bd8653aa47d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DSN_API void dsn_msg_write_next </td>
          <td>(</td>
          <td class="paramtype">dsn_message_t&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>min_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get message write buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>message handle </td></tr>
    <tr><td class="paramname">ptr</td><td>*ptr returns the writable memory pointer </td></tr>
    <tr><td class="paramname">size</td><td>*size returns the writable memory buffer size </td></tr>
    <tr><td class="paramname">min_size</td><td>*size must &gt;= min_size </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gab86d05d5ba0b278caa1624ef390fc5f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DSN_API bool dsn_msg_read_next </td>
          <td>(</td>
          <td class="paramtype">dsn_message_t&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get message read buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>message handle </td></tr>
    <tr><td class="paramname">ptr</td><td>*ptr points to the next read buffer </td></tr>
    <tr><td class="paramname">size</td><td>*size points to the size of the next buffer filled with content</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if it succeeds, false if it is already beyond the end of the message </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
