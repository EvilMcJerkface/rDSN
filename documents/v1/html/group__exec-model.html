<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>rDSN: Programming Model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rDSN
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Programming Model<div class="ingroups"><a class="el" href="group__layer1-dev.html">Write Applications in rDSN</a> &raquo; <a class="el" href="group__layer1-dev-models.html">Overview</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The programming and execution model for rDSN applications.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdsn_1_1task__code.html">dsn::task_code</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdsn_1_1threadpool__code.html">dsn::threadpool_code</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab2a136866747de232ecd9a4769be8810"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab2a136866747de232ecd9a4769be8810"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFINE_NAMED_TASK_CODE</b>(x,  name,  pri,  pool)&#160;&#160;&#160;__selectany const ::<a class="el" href="classdsn_1_1task__code.html">dsn::task_code</a> x(#name, <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a310b24b0d82cc0ecdc8de6784c3ad21e">TASK_TYPE_COMPUTE</a>, pri, pool);</td></tr>
<tr class="separator:gab2a136866747de232ecd9a4769be8810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd9b1f40cc1b895fa95b42352e59aee1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabd9b1f40cc1b895fa95b42352e59aee1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFINE_NAMED_TASK_CODE_AIO</b>(x,  name,  pri,  pool)&#160;&#160;&#160;__selectany const ::<a class="el" href="classdsn_1_1task__code.html">dsn::task_code</a> x(#name, <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a169c3edaf32719600233fef3f987fa02">TASK_TYPE_AIO</a>, pri, pool);</td></tr>
<tr class="separator:gabd9b1f40cc1b895fa95b42352e59aee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2545031c9e44e79c5cf52ba9316b1e6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFINE_NAMED_TASK_CODE_RPC</b>(x,  name,  pri,  pool)</td></tr>
<tr class="separator:ga2545031c9e44e79c5cf52ba9316b1e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad300b5cb7c1394072c54507b6e362611"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad300b5cb7c1394072c54507b6e362611"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#gad300b5cb7c1394072c54507b6e362611">DEFINE_TASK_CODE</a>(x,  pri,  pool)&#160;&#160;&#160;DEFINE_NAMED_TASK_CODE(x, x, pri, pool)</td></tr>
<tr class="memdesc:gad300b5cb7c1394072c54507b6e362611"><td class="mdescLeft">&#160;</td><td class="mdescRight">define a new task code with TASK_TYPE_COMPUTATION <br /></td></tr>
<tr class="separator:gad300b5cb7c1394072c54507b6e362611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35eb1e0dd83349db40dd3b6168c068ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga35eb1e0dd83349db40dd3b6168c068ba"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFINE_TASK_CODE_AIO</b>(x,  pri,  pool)&#160;&#160;&#160;DEFINE_NAMED_TASK_CODE_AIO(x, x, pri, pool)</td></tr>
<tr class="separator:ga35eb1e0dd83349db40dd3b6168c068ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1a3bda0b6cc484baf10df437e933ba7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad1a3bda0b6cc484baf10df437e933ba7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFINE_TASK_CODE_RPC</b>(x,  pri,  pool)&#160;&#160;&#160;DEFINE_NAMED_TASK_CODE_RPC(x, x, pri, pool)</td></tr>
<tr class="separator:gad1a3bda0b6cc484baf10df437e933ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3">DEFINE_THREAD_POOL_CODE</a>(x)&#160;&#160;&#160;__selectany const ::<a class="el" href="classdsn_1_1threadpool__code.html">dsn::threadpool_code</a> x(#x);</td></tr>
<tr class="memdesc:ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">define a new thread pool named x <br /></td></tr>
<tr class="separator:ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga84ef868e609f93be7044c749df9fe0d0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga84ef868e609f93be7044c749df9fe0d0"></a>
typedef enum <a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga84ef868e609f93be7044c749df9fe0d0">dsn_task_type_t</a></td></tr>
<tr class="memdesc:ga84ef868e609f93be7044c749df9fe0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">task/event type definition <br /></td></tr>
<tr class="separator:ga84ef868e609f93be7044c749df9fe0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14718b967ec3ea97cd3dba20ada415c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga14718b967ec3ea97cd3dba20ada415c8"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga14718b967ec3ea97cd3dba20ada415c8">dsn_task_handler_t</a>) (void *)</td></tr>
<tr class="memdesc:ga14718b967ec3ea97cd3dba20ada415c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback prototype for <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a310b24b0d82cc0ecdc8de6784c3ad21e">TASK_TYPE_COMPUTE</a> <br /></td></tr>
<tr class="separator:ga14718b967ec3ea97cd3dba20ada415c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fd5300dcd75225d3420c0f2b71ea7f1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga7fd5300dcd75225d3420c0f2b71ea7f1"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga7fd5300dcd75225d3420c0f2b71ea7f1">dsn_rpc_request_handler_t</a>) (dsn_message_t, void *)</td></tr>
<tr class="memdesc:ga7fd5300dcd75225d3420c0f2b71ea7f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback prototype for <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8">TASK_TYPE_RPC_REQUEST</a> <br /></td></tr>
<tr class="separator:ga7fd5300dcd75225d3420c0f2b71ea7f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16b06dc4b92bbf395490fa63edaba2ab"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga16b06dc4b92bbf395490fa63edaba2ab"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga16b06dc4b92bbf395490fa63edaba2ab">dsn_rpc_response_handler_t</a>) (dsn_error_t, dsn_message_t, dsn_message_t, void *)</td></tr>
<tr class="memdesc:ga16b06dc4b92bbf395490fa63edaba2ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback prototype for <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d">TASK_TYPE_RPC_RESPONSE</a> <br /></td></tr>
<tr class="separator:ga16b06dc4b92bbf395490fa63edaba2ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1649c0fb4cf4fa3357f42434a74e78a8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1649c0fb4cf4fa3357f42434a74e78a8"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga1649c0fb4cf4fa3357f42434a74e78a8">dsn_aio_handler_t</a>) (dsn_error_t, size_t, void *)</td></tr>
<tr class="memdesc:ga1649c0fb4cf4fa3357f42434a74e78a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback prototype for <a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a169c3edaf32719600233fef3f987fa02">TASK_TYPE_AIO</a> <br /></td></tr>
<tr class="separator:ga1649c0fb4cf4fa3357f42434a74e78a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa651801ce5668d46cfad11f5c3ef939a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa651801ce5668d46cfad11f5c3ef939a"></a>
typedef enum <a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#gaa651801ce5668d46cfad11f5c3ef939a">dsn_task_priority_t</a></td></tr>
<tr class="memdesc:gaa651801ce5668d46cfad11f5c3ef939a"><td class="mdescLeft">&#160;</td><td class="mdescRight">task priority <br /></td></tr>
<tr class="separator:gaa651801ce5668d46cfad11f5c3ef939a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1118e5a89dcd664ca5315b30b68bbee5"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga1118e5a89dcd664ca5315b30b68bbee5">dsn_task_cancelled_handler_t</a>) (void *)</td></tr>
<tr class="memdesc:ga1118e5a89dcd664ca5315b30b68bbee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback prototype for task cancellation (called on task-being-cancelled)  <a href="#ga1118e5a89dcd664ca5315b30b68bbee5">More...</a><br /></td></tr>
<tr class="separator:ga1118e5a89dcd664ca5315b30b68bbee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaaef99f60d299e960b5910c1a19f36312"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a> { <br />
&#160;&#160;<a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8">TASK_TYPE_RPC_REQUEST</a>, 
<a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d">TASK_TYPE_RPC_RESPONSE</a>, 
<a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a310b24b0d82cc0ecdc8de6784c3ad21e">TASK_TYPE_COMPUTE</a>, 
<a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a169c3edaf32719600233fef3f987fa02">TASK_TYPE_AIO</a>, 
<br />
&#160;&#160;<a class="el" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312ae61f42bc61de34ce7dc05a414027b101">TASK_TYPE_CONTINUATION</a>, 
<b>TASK_TYPE_COUNT</b>, 
<b>TASK_TYPE_INVALID</b>
<br />
 }<tr class="memdesc:gaaef99f60d299e960b5910c1a19f36312"><td class="mdescLeft">&#160;</td><td class="mdescRight">task/event type definition  <a href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:gaaef99f60d299e960b5910c1a19f36312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga750b2e748468dd17a36c4b5ecbb23155"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga750b2e748468dd17a36c4b5ecbb23155"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a> { <br />
&#160;&#160;<b>TASK_PRIORITY_LOW</b>, 
<b>TASK_PRIORITY_COMMON</b>, 
<b>TASK_PRIORITY_HIGH</b>, 
<b>TASK_PRIORITY_COUNT</b>, 
<br />
&#160;&#160;<b>TASK_PRIORITY_INVALID</b>
<br />
 }<tr class="memdesc:ga750b2e748468dd17a36c4b5ecbb23155"><td class="mdescLeft">&#160;</td><td class="mdescRight">task priority <br /></td></tr>
</td></tr>
<tr class="separator:ga750b2e748468dd17a36c4b5ecbb23155"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2d4b0591b55e107d932446873619bdc1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2d4b0591b55e107d932446873619bdc1"></a>
DSN_API dsn_threadpool_code_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga2d4b0591b55e107d932446873619bdc1">dsn_threadpool_code_register</a> (const char *name)</td></tr>
<tr class="memdesc:ga2d4b0591b55e107d932446873619bdc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">define a new thread pool with a given name <br /></td></tr>
<tr class="separator:ga2d4b0591b55e107d932446873619bdc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad53ac225dc96e2683d94a515443f2eee"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad53ac225dc96e2683d94a515443f2eee"></a>
DSN_API const char *&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_threadpool_code_to_string</b> (dsn_threadpool_code_t pool_code)</td></tr>
<tr class="separator:gad53ac225dc96e2683d94a515443f2eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1bf80383d5eace79bb658b8b0e6c8fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf1bf80383d5eace79bb658b8b0e6c8fa"></a>
DSN_API dsn_threadpool_code_t&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_threadpool_code_from_string</b> (const char *s, dsn_threadpool_code_t default_code)</td></tr>
<tr class="separator:gaf1bf80383d5eace79bb658b8b0e6c8fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafabc47ce826c90fe7271d3a7702bd68b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafabc47ce826c90fe7271d3a7702bd68b"></a>
DSN_API int&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_threadpool_code_max</b> ()</td></tr>
<tr class="separator:gafabc47ce826c90fe7271d3a7702bd68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga676b292869c97b78f583eb1591ffa6a0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga676b292869c97b78f583eb1591ffa6a0"></a>
DSN_API int&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_threadpool_get_current_tid</b> ()</td></tr>
<tr class="separator:ga676b292869c97b78f583eb1591ffa6a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga352ecfed1f48af9076ce346f03e0df77"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga352ecfed1f48af9076ce346f03e0df77"></a>
DSN_API dsn_task_code_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga352ecfed1f48af9076ce346f03e0df77">dsn_task_code_register</a> (const char *name, <a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a> type, <a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a>, dsn_threadpool_code_t pool)</td></tr>
<tr class="memdesc:ga352ecfed1f48af9076ce346f03e0df77"><td class="mdescLeft">&#160;</td><td class="mdescRight">register a new task code <br /></td></tr>
<tr class="separator:ga352ecfed1f48af9076ce346f03e0df77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2902f132dab828511664a97764a7651a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2902f132dab828511664a97764a7651a"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_query</b> (dsn_task_code_t code, <a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a> *ptype, <a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a> *ppri, dsn_threadpool_code_t *ppool)</td></tr>
<tr class="separator:ga2902f132dab828511664a97764a7651a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3b943192114b297889fb7da4ccaa054"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa3b943192114b297889fb7da4ccaa054"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_set_threadpool</b> (dsn_task_code_t code, dsn_threadpool_code_t pool)</td></tr>
<tr class="separator:gaa3b943192114b297889fb7da4ccaa054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10f7aa815e608aa86bafd37c42591194"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga10f7aa815e608aa86bafd37c42591194"></a>
DSN_API void&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_set_priority</b> (dsn_task_code_t code, <a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a> pri)</td></tr>
<tr class="separator:ga10f7aa815e608aa86bafd37c42591194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga448259a49699b542e6acf4b712925872"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga448259a49699b542e6acf4b712925872"></a>
DSN_API const char *&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_to_string</b> (dsn_task_code_t code)</td></tr>
<tr class="separator:ga448259a49699b542e6acf4b712925872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8d031fa1c536d3728274ef509768e4e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa8d031fa1c536d3728274ef509768e4e"></a>
DSN_API dsn_task_code_t&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_from_string</b> (const char *s, dsn_task_code_t default_code)</td></tr>
<tr class="separator:gaa8d031fa1c536d3728274ef509768e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e95e9ac2f3cf8b3fb854f4e1e7b9124"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6e95e9ac2f3cf8b3fb854f4e1e7b9124"></a>
DSN_API int&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_code_max</b> ()</td></tr>
<tr class="separator:ga6e95e9ac2f3cf8b3fb854f4e1e7b9124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ea2018168fde87829cf6086ebb07306"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2ea2018168fde87829cf6086ebb07306"></a>
DSN_API const char *&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_type_to_string</b> (<a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a> tt)</td></tr>
<tr class="separator:ga2ea2018168fde87829cf6086ebb07306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga873429c01e7b53dbd660610f3dcce399"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga873429c01e7b53dbd660610f3dcce399"></a>
DSN_API const char *&#160;</td><td class="memItemRight" valign="bottom"><b>dsn_task_priority_to_string</b> (<a class="el" href="group__exec-model.html#ga750b2e748468dd17a36c4b5ecbb23155">dsn_task_priority_t</a> tt)</td></tr>
<tr class="separator:ga873429c01e7b53dbd660610f3dcce399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93612e4cc989f28f027bbcd37b5ae19e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga93612e4cc989f28f027bbcd37b5ae19e"></a>
DSN_API volatile int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__exec-model.html#ga93612e4cc989f28f027bbcd37b5ae19e">dsn_task_queue_virtual_length_ptr</a> (dsn_task_code_t code, int hash DEFAULT(0))</td></tr>
<tr class="memdesc:ga93612e4cc989f28f027bbcd37b5ae19e"><td class="mdescLeft">&#160;</td><td class="mdescRight">apps updates the value at dsn_task_queue_virtual_length_ptr(..) to control the length of a vitual queue (bound to current code + hash) to enable customized throttling, see spec of thread pool for more information <br /></td></tr>
<tr class="separator:ga93612e4cc989f28f027bbcd37b5ae19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The programming and execution model for rDSN applications. </p>
<p>rDSN adopts the event-driven programming model, where all computations are represented as a task/event, which is the execution of a sequential piece of code in one thread. Specifically, rDSN categorizes the tasks into four types, as defined in <a class="el" href="group__exec-model.html#ga84ef868e609f93be7044c749df9fe0d0">dsn_task_type_t</a>.</p>
<p>Unlike the traditional event-driven programming, rDSN enhances the model in the following ways, with which they control the application in many aspects in a declarative approach.</p>
<ul>
<li><p class="startli">each task is labeled with a task code, with which developers can configure many aspects in config files. Developers can define new task code using <a class="el" href="group__exec-model.html#gad300b5cb7c1394072c54507b6e362611">DEFINE_TASK_CODE</a>, or <a class="el" href="group__exec-model.html#ga352ecfed1f48af9076ce346f03e0df77">dsn_task_code_register</a>.</p>
<pre>
  [task..default]
  ; allow task executed in other thread pools or tasks 
  ; for TASK_TYPE_COMPUTE - allow-inline allows a task being executed in its caller site 
  ; for other tasks - allow-inline allows a task being execution in io-thread
  allow_inline = false</pre><pre>  ; group rpc mode with group address: GRPC_TO_LEADER, GRPC_TO_ALL, GRPC_TO_ANY
  grpc_mode = GRPC_TO_LEADER</pre><pre>  ; when toollet profiler is enabled
  is_profile = true</pre><pre>  ; when toollet tracer is enabled
  is_trace = true</pre><pre>  ; thread pool to execute the task
  pool_code = THREAD_POOL_DEFAULT</pre><pre>  ; task priority
  priority = TASK_PRIORITY_COMMON</pre><pre>  ; whether to randomize the timer delay to random(0, timer_interval), 
  ; if the initial delay is zero, to avoid multiple timers executing at the same time (e.g., checkpointing)
  randomize_timer_delay_if_zero = false</pre><pre>  ; what kind of network channel for this kind of rpc calls
  rpc_call_channel = RPC_CHANNEL_TCP</pre><pre>  ; what kind of header format for this kind of rpc calls
  rpc_call_header_format = NET_HDR_DSN</pre><pre>  ; how many milliseconds to delay recving rpc session for 
  ; when queue length ~= [1.0, 1.2, 1.4, 1.6, 1.8, &gt;=2.0] x pool.queue_length_throttling_threshold,
  ; e.g., 0, 0, 1, 2, 5, 10
  rpc_request_delays_milliseconds = 0, 0, 1, 2, 5, 10</pre><pre>  ; whether to drop a request right before execution when its queueing time 
  ; is already greater than its timeout value
  rpc_request_dropped_before_execution_when_timeout = false</pre><pre>  ; for how long (ms) the request will be resent if no response 
  ; is received yet, 0 for disable this feature
  rpc_request_resend_timeout_milliseconds = 0</pre><pre>  ; throttling mode for rpc requets: TM_NONE, TM_REJECT, TM_DELAY when 
  ; queue length &gt; pool.queue_length_throttling_threshold
  rpc_request_throttling_mode = TM_NONE</pre><pre>  ; what is the default timeout (ms) for this kind of rpc calls
  rpc_timeout_milliseconds = 5000</pre><pre>  [task.LPC_AIO_IMMEDIATE_CALLBACK]
  ; override the option in [task..default]
  allow_inline = true
  </pre></li>
<li><p class="startli">each task code is bound to a thread pool, which can be customized as follows. Developers can define new thread pools using <a class="el" href="group__exec-model.html#ga6c2e4fb2d6f13a718fc4c71ba3f1c0a3">DEFINE_THREAD_POOL_CODE</a>, or <a class="el" href="group__exec-model.html#ga2d4b0591b55e107d932446873619bdc1">dsn_threadpool_code_register</a>.</p>
<pre>
  [threadpool..default]</pre><pre>  ; how many tasks (if available) should be returned for
  ; one dequeue call for best batching performance
  dequeue_batch_size = 5</pre><pre>  ; throttling: whether to enable throttling with virtual queues
  enable_virtual_queue_throttling = false</pre><pre>  ; thread pool name
  name = THREAD_POOL_INVALID</pre><pre>  ; whethe the threads share a single queue(partitioned=false) or not;
  ; the latter is usually for workload hash partitioning for avoiding locking
  partitioned = false</pre><pre>  ; task queue aspects names, usually for tooling purpose
  queue_aspects =</pre><pre>  ; task queue provider name
  queue_factory_name = dsn::tools::hpc_concurrent_task_queue</pre><pre>  ; throttling: throttling threshold above which rpc requests will be dropped
  queue_length_throttling_threshold = 1000000</pre><pre>  ; what CPU cores are assigned to this pool, 0 for all
  worker_affinity_mask = 0</pre><pre>  ; task aspects names, usually for tooling purpose
  worker_aspects =</pre><pre>  ; thread/worker count
  worker_count = 2</pre><pre>  ; task worker provider name
  worker_factory_name =</pre><pre>  ; thread priority
  worker_priority = THREAD_xPRIORITY_NORMAL</pre><pre>  ; whether the threads share all assigned cores
  worker_share_core = true</pre><pre>  [threadpool.THREAD_POOL_DEFAULT]
  ; override default options in [threadpool..default]
  dequeue_batch_size = 5</pre><pre>  </pre></li>
<li></li>
</ul>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga2545031c9e44e79c5cf52ba9316b1e6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFINE_NAMED_TASK_CODE_RPC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pri, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pool&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">__selectany const ::dsn::task_code x(#name, <a class="code" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8">TASK_TYPE_RPC_REQUEST</a>, pri, pool); \</div><div class="line">        __selectany const ::dsn::task_code x##_ACK(#name<span class="stringliteral">&quot;_ACK&quot;</span>, <a class="code" href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d">TASK_TYPE_RPC_RESPONSE</a>, pri, pool);</div><div class="ttc" id="group__exec-model_html_ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d"><div class="ttname"><a href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d">TASK_TYPE_RPC_RESPONSE</a></div><div class="ttdoc">task handling rpc response or timeout </div><div class="ttdef"><b>Definition:</b> api_task.h:178</div></div>
<div class="ttc" id="group__exec-model_html_ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8"><div class="ttname"><a href="group__exec-model.html#ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8">TASK_TYPE_RPC_REQUEST</a></div><div class="ttdoc">task handling rpc request </div><div class="ttdef"><b>Definition:</b> api_task.h:177</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga1118e5a89dcd664ca5315b30b68bbee5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* dsn_task_cancelled_handler_t) (void * )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>callback prototype for task cancellation (called on task-being-cancelled) </p>
<p>in rDSN, tasks can be cancelled. For languages such as C++, when there are explicit resource release operations (e.g., ::free, release_ref()) in the task handlers, cancellation will cause resource leak due to not-executed task handleers. in order to support such scenario, rDSN provides dsn_task_cancelled_handler_t which is executed when a task is cancelled. Note this callback does not have thread affinity similar to task handlers above (which are configured to be executed in certain thread pools or even a fixed thread). Therefore, it is developers' resposibility to ensure this cancallation callback only does thread-insensitive operations (e.g., release_ref()). </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="gaaef99f60d299e960b5910c1a19f36312"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__exec-model.html#gaaef99f60d299e960b5910c1a19f36312">dsn_task_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>task/event type definition </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ggaaef99f60d299e960b5910c1a19f36312ab93cdaa737723ad06381d93f9d04e1b8"></a>TASK_TYPE_RPC_REQUEST&#160;</td><td class="fielddoc">
<p>task handling rpc request </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaaef99f60d299e960b5910c1a19f36312a0a71c16dfd7ae6d8763a56f7512c8b8d"></a>TASK_TYPE_RPC_RESPONSE&#160;</td><td class="fielddoc">
<p>task handling rpc response or timeout </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaaef99f60d299e960b5910c1a19f36312a310b24b0d82cc0ecdc8de6784c3ad21e"></a>TASK_TYPE_COMPUTE&#160;</td><td class="fielddoc">
<p>async calls or timers </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaaef99f60d299e960b5910c1a19f36312a169c3edaf32719600233fef3f987fa02"></a>TASK_TYPE_AIO&#160;</td><td class="fielddoc">
<p>callback for file read and write </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaaef99f60d299e960b5910c1a19f36312ae61f42bc61de34ce7dc05a414027b101"></a>TASK_TYPE_CONTINUATION&#160;</td><td class="fielddoc">
<p>above tasks are seperated into several continuation tasks by thread-synchronization operations. </p>
<p>so that each "task" is non-blocking </p>
</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
